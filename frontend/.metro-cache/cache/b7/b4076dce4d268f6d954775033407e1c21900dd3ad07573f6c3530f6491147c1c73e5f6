{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":69,"index":103}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../lib/supabaseClient","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":71,"index":175}}],"key":"dTfEBkCfNr36iGOmi29Lo0LUD+k=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuthStore\", {\n    enumerable: true,\n    get: function () {\n      return useAuthStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _libSupabaseClient = require(_dependencyMap[2], \"../lib/supabaseClient\");\n  // Custom user type for our app_users table\n\n  const AUTH_STORAGE_KEY = '@fittrack_auth_user';\n  const useAuthStore = (0, _zustand.create)((set, get) => ({\n    user: null,\n    isLoading: false,\n    error: null,\n    debugLog: null,\n    setUser: user => set({\n      user\n    }),\n    setError: error => set({\n      error\n    }),\n    // Custom login using app_users table\n    login: async (email, password) => {\n      set({\n        isLoading: true,\n        error: null,\n        debugLog: null\n      });\n      const supabase = (0, _libSupabaseClient.getSupabase)();\n      if (!supabase) {\n        set({\n          isLoading: false,\n          error: 'Supabase not configured'\n        });\n        return false;\n      }\n      const logLines = [];\n      logLines.push(`[Auth] Custom login with app_users table`);\n      logLines.push(`  email: ${email}`);\n      try {\n        console.log('[Auth] Attempting custom login with email:', email);\n\n        // Query the app_users table for matching credentials\n        const {\n          data,\n          error\n        } = await supabase.from('app_users').select('id, email, created_at, updated_at').eq('email', email).eq('password_hash', password).single();\n        if (error) {\n          logLines.push(`[Auth] ERROR:`);\n          logLines.push(`  code: ${error.code}`);\n          logLines.push(`  message: ${error.message}`);\n          console.log('[Auth] Login ERROR:', error);\n          let errorMsg = 'Invalid email or password';\n          if (error.code === 'PGRST116') {\n            errorMsg = 'Invalid email or password';\n          } else {\n            errorMsg = error.message;\n          }\n          set({\n            isLoading: false,\n            error: errorMsg,\n            debugLog: logLines.join('\\n')\n          });\n          return false;\n        }\n        if (!data) {\n          logLines.push(`[Auth] No user found`);\n          set({\n            isLoading: false,\n            error: 'Invalid email or password',\n            debugLog: logLines.join('\\n')\n          });\n          return false;\n        }\n        logLines.push(`[Auth] SUCCESS`);\n        logLines.push(`  user_id: ${data.id}`);\n        logLines.push(`  email: ${data.email}`);\n        console.log('[Auth] Login SUCCESS, user:', data.email);\n        const appUser = {\n          id: data.id,\n          email: data.email,\n          created_at: data.created_at,\n          updated_at: data.updated_at\n        };\n\n        // Save user to AsyncStorage for session persistence\n        await AsyncStorage.default.setItem(AUTH_STORAGE_KEY, JSON.stringify(appUser));\n        set({\n          user: appUser,\n          isLoading: false,\n          debugLog: logLines.join('\\n')\n        });\n        return true;\n      } catch (err) {\n        logLines.push(`[Auth] EXCEPTION: ${err.message}`);\n        console.log('[Auth] Login EXCEPTION:', err);\n        set({\n          isLoading: false,\n          error: `Unexpected error: ${err.message}`,\n          debugLog: logLines.join('\\n')\n        });\n        return false;\n      }\n    },\n    // Demo login using environment variables\n    demoLogin: async () => {\n      const config = (0, _libSupabaseClient.getSupabaseConfig)();\n      if (!config.hasDemoCredentials) {\n        set({\n          error: 'Demo credentials not configured. Please set EXPO_PUBLIC_DEMO_EMAIL and EXPO_PUBLIC_DEMO_PASSWORD.'\n        });\n        return false;\n      }\n      return get().login(config.demoEmail, config.demoPassword);\n    },\n    signOut: async () => {\n      try {\n        await AsyncStorage.default.removeItem(AUTH_STORAGE_KEY);\n      } catch (err) {\n        console.log('Error removing auth storage:', err);\n      }\n      set({\n        user: null\n      });\n    },\n    checkSession: async () => {\n      try {\n        const storedUser = await AsyncStorage.default.getItem(AUTH_STORAGE_KEY);\n        if (storedUser) {\n          const user = JSON.parse(storedUser);\n          console.log('[Auth] Restored session for user:', user.email);\n          set({\n            user\n          });\n        }\n      } catch (err) {\n        console.log('Error checking session:', err);\n      }\n    }\n  }));\n});","lineCount":155,"map":[[12,2,28,0,"Object"],[12,8,28,0],[12,9,28,0,"defineProperty"],[12,23,28,0],[12,24,28,0,"exports"],[12,31,28,0],[13,4,28,0,"enumerable"],[13,14,28,0],[14,4,28,0,"get"],[14,7,28,0],[14,18,28,0,"get"],[14,19,28,0],[15,6,28,0],[15,13,28,0,"useAuthStore"],[15,25,28,0],[16,4,28,0],[17,2,28,0],[18,2,1,0],[18,6,1,0,"_zustand"],[18,14,1,0],[18,17,1,0,"require"],[18,24,1,0],[18,25,1,0,"_dependencyMap"],[18,39,1,0],[19,2,2,0],[19,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,42,2,0],[19,45,2,0,"require"],[19,52,2,0],[19,53,2,0,"_dependencyMap"],[19,67,2,0],[20,2,2,0],[20,6,2,0,"AsyncStorage"],[20,18,2,0],[20,21,2,0,"_interopDefault"],[20,36,2,0],[20,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[20,73,2,0],[21,2,3,0],[21,6,3,0,"_libSupabaseClient"],[21,24,3,0],[21,27,3,0,"require"],[21,34,3,0],[21,35,3,0,"_dependencyMap"],[21,49,3,0],[22,2,5,0],[24,2,26,0],[24,8,26,6,"AUTH_STORAGE_KEY"],[24,24,26,22],[24,27,26,25],[24,48,26,46],[25,2,28,7],[25,8,28,13,"useAuthStore"],[25,20,28,25],[25,23,28,28],[25,27,28,28,"create"],[25,35,28,34],[25,36,28,34,"create"],[25,42,28,34],[25,44,28,46],[25,45,28,47,"set"],[25,48,28,50],[25,50,28,52,"get"],[25,53,28,55],[25,59,28,61],[26,4,29,2,"user"],[26,8,29,6],[26,10,29,8],[26,14,29,12],[27,4,30,2,"isLoading"],[27,13,30,11],[27,15,30,13],[27,20,30,18],[28,4,31,2,"error"],[28,9,31,7],[28,11,31,9],[28,15,31,13],[29,4,32,2,"debugLog"],[29,12,32,10],[29,14,32,12],[29,18,32,16],[30,4,34,2,"setUser"],[30,11,34,9],[30,13,34,12,"user"],[30,17,34,16],[30,21,34,21,"set"],[30,24,34,24],[30,25,34,25],[31,6,34,27,"user"],[32,4,34,32],[32,5,34,33],[32,6,34,34],[33,4,35,2,"setError"],[33,12,35,10],[33,14,35,13,"error"],[33,19,35,18],[33,23,35,23,"set"],[33,26,35,26],[33,27,35,27],[34,6,35,29,"error"],[35,4,35,35],[35,5,35,36],[35,6,35,37],[36,4,37,2],[37,4,38,2,"login"],[37,9,38,7],[37,11,38,9],[37,17,38,9,"login"],[37,18,38,16,"email"],[37,23,38,29],[37,25,38,31,"password"],[37,33,38,47],[37,38,38,52],[38,6,39,4,"set"],[38,9,39,7],[38,10,39,8],[39,8,39,10,"isLoading"],[39,17,39,19],[39,19,39,21],[39,23,39,25],[40,8,39,27,"error"],[40,13,39,32],[40,15,39,34],[40,19,39,38],[41,8,39,40,"debugLog"],[41,16,39,48],[41,18,39,50],[42,6,39,55],[42,7,39,56],[42,8,39,57],[43,6,41,4],[43,12,41,10,"supabase"],[43,20,41,18],[43,23,41,21],[43,27,41,21,"getSupabase"],[43,45,41,32],[43,46,41,32,"getSupabase"],[43,57,41,32],[43,59,41,33],[43,60,41,34],[44,6,42,4],[44,10,42,8],[44,11,42,9,"supabase"],[44,19,42,17],[44,21,42,19],[45,8,43,6,"set"],[45,11,43,9],[45,12,43,10],[46,10,43,12,"isLoading"],[46,19,43,21],[46,21,43,23],[46,26,43,28],[47,10,43,30,"error"],[47,15,43,35],[47,17,43,37],[48,8,43,63],[48,9,43,64],[48,10,43,65],[49,8,44,6],[49,15,44,13],[49,20,44,18],[50,6,45,4],[51,6,47,4],[51,12,47,10,"logLines"],[51,20,47,28],[51,23,47,31],[51,25,47,33],[52,6,48,4,"logLines"],[52,14,48,12],[52,15,48,13,"push"],[52,19,48,17],[52,20,48,18],[52,62,48,60],[52,63,48,61],[53,6,49,4,"logLines"],[53,14,49,12],[53,15,49,13,"push"],[53,19,49,17],[53,20,49,18],[53,32,49,30,"email"],[53,37,49,35],[53,39,49,37],[53,40,49,38],[54,6,51,4],[54,10,51,8],[55,8,52,6,"console"],[55,15,52,13],[55,16,52,14,"log"],[55,19,52,17],[55,20,52,18],[55,64,52,62],[55,66,52,64,"email"],[55,71,52,69],[55,72,52,70],[57,8,54,6],[58,8,55,6],[58,14,55,12],[59,10,55,14,"data"],[59,14,55,18],[60,10,55,20,"error"],[61,8,55,26],[61,9,55,27],[61,12,55,30],[61,18,55,36,"supabase"],[61,26,55,44],[61,27,56,9,"from"],[61,31,56,13],[61,32,56,14],[61,43,56,25],[61,44,56,26],[61,45,57,9,"select"],[61,51,57,15],[61,52,57,16],[61,87,57,51],[61,88,57,52],[61,89,58,9,"eq"],[61,91,58,11],[61,92,58,12],[61,99,58,19],[61,101,58,21,"email"],[61,106,58,26],[61,107,58,27],[61,108,59,9,"eq"],[61,110,59,11],[61,111,59,12],[61,126,59,27],[61,128,59,29,"password"],[61,136,59,37],[61,137,59,38],[61,138,60,9,"single"],[61,144,60,15],[61,145,60,16],[61,146,60,17],[62,8,62,6],[62,12,62,10,"error"],[62,17,62,15],[62,19,62,17],[63,10,63,8,"logLines"],[63,18,63,16],[63,19,63,17,"push"],[63,23,63,21],[63,24,63,22],[63,39,63,37],[63,40,63,38],[64,10,64,8,"logLines"],[64,18,64,16],[64,19,64,17,"push"],[64,23,64,21],[64,24,64,22],[64,35,64,33,"error"],[64,40,64,38],[64,41,64,39,"code"],[64,45,64,43],[64,47,64,45],[64,48,64,46],[65,10,65,8,"logLines"],[65,18,65,16],[65,19,65,17,"push"],[65,23,65,21],[65,24,65,22],[65,38,65,36,"error"],[65,43,65,41],[65,44,65,42,"message"],[65,51,65,49],[65,53,65,51],[65,54,65,52],[66,10,67,8,"console"],[66,17,67,15],[66,18,67,16,"log"],[66,21,67,19],[66,22,67,20],[66,43,67,41],[66,45,67,43,"error"],[66,50,67,48],[66,51,67,49],[67,10,69,8],[67,14,69,12,"errorMsg"],[67,22,69,20],[67,25,69,23],[67,52,69,50],[68,10,70,8],[68,14,70,12,"error"],[68,19,70,17],[68,20,70,18,"code"],[68,24,70,22],[68,29,70,27],[68,39,70,37],[68,41,70,39],[69,12,71,10,"errorMsg"],[69,20,71,18],[69,23,71,21],[69,50,71,48],[70,10,72,8],[70,11,72,9],[70,17,72,15],[71,12,73,10,"errorMsg"],[71,20,73,18],[71,23,73,21,"error"],[71,28,73,26],[71,29,73,27,"message"],[71,36,73,34],[72,10,74,8],[73,10,76,8,"set"],[73,13,76,11],[73,14,76,12],[74,12,76,14,"isLoading"],[74,21,76,23],[74,23,76,25],[74,28,76,30],[75,12,76,32,"error"],[75,17,76,37],[75,19,76,39,"errorMsg"],[75,27,76,47],[76,12,76,49,"debugLog"],[76,20,76,57],[76,22,76,59,"logLines"],[76,30,76,67],[76,31,76,68,"join"],[76,35,76,72],[76,36,76,73],[76,40,76,77],[77,10,76,79],[77,11,76,80],[77,12,76,81],[78,10,77,8],[78,17,77,15],[78,22,77,20],[79,8,78,6],[80,8,80,6],[80,12,80,10],[80,13,80,11,"data"],[80,17,80,15],[80,19,80,17],[81,10,81,8,"logLines"],[81,18,81,16],[81,19,81,17,"push"],[81,23,81,21],[81,24,81,22],[81,46,81,44],[81,47,81,45],[82,10,82,8,"set"],[82,13,82,11],[82,14,82,12],[83,12,82,14,"isLoading"],[83,21,82,23],[83,23,82,25],[83,28,82,30],[84,12,82,32,"error"],[84,17,82,37],[84,19,82,39],[84,46,82,66],[85,12,82,68,"debugLog"],[85,20,82,76],[85,22,82,78,"logLines"],[85,30,82,86],[85,31,82,87,"join"],[85,35,82,91],[85,36,82,92],[85,40,82,96],[86,10,82,98],[86,11,82,99],[86,12,82,100],[87,10,83,8],[87,17,83,15],[87,22,83,20],[88,8,84,6],[89,8,86,6,"logLines"],[89,16,86,14],[89,17,86,15,"push"],[89,21,86,19],[89,22,86,20],[89,38,86,36],[89,39,86,37],[90,8,87,6,"logLines"],[90,16,87,14],[90,17,87,15,"push"],[90,21,87,19],[90,22,87,20],[90,36,87,34,"data"],[90,40,87,38],[90,41,87,39,"id"],[90,43,87,41],[90,45,87,43],[90,46,87,44],[91,8,88,6,"logLines"],[91,16,88,14],[91,17,88,15,"push"],[91,21,88,19],[91,22,88,20],[91,34,88,32,"data"],[91,38,88,36],[91,39,88,37,"email"],[91,44,88,42],[91,46,88,44],[91,47,88,45],[92,8,89,6,"console"],[92,15,89,13],[92,16,89,14,"log"],[92,19,89,17],[92,20,89,18],[92,49,89,47],[92,51,89,49,"data"],[92,55,89,53],[92,56,89,54,"email"],[92,61,89,59],[92,62,89,60],[93,8,91,6],[93,14,91,12,"appUser"],[93,21,91,28],[93,24,91,31],[94,10,92,8,"id"],[94,12,92,10],[94,14,92,12,"data"],[94,18,92,16],[94,19,92,17,"id"],[94,21,92,19],[95,10,93,8,"email"],[95,15,93,13],[95,17,93,15,"data"],[95,21,93,19],[95,22,93,20,"email"],[95,27,93,25],[96,10,94,8,"created_at"],[96,20,94,18],[96,22,94,20,"data"],[96,26,94,24],[96,27,94,25,"created_at"],[96,37,94,35],[97,10,95,8,"updated_at"],[97,20,95,18],[97,22,95,20,"data"],[97,26,95,24],[97,27,95,25,"updated_at"],[98,8,96,6],[98,9,96,7],[100,8,98,6],[101,8,99,6],[101,14,99,12,"AsyncStorage"],[101,26,99,24],[101,27,99,24,"default"],[101,34,99,24],[101,35,99,25,"setItem"],[101,42,99,32],[101,43,99,33,"AUTH_STORAGE_KEY"],[101,59,99,49],[101,61,99,51,"JSON"],[101,65,99,55],[101,66,99,56,"stringify"],[101,75,99,65],[101,76,99,66,"appUser"],[101,83,99,73],[101,84,99,74],[101,85,99,75],[102,8,101,6,"set"],[102,11,101,9],[102,12,101,10],[103,10,101,12,"user"],[103,14,101,16],[103,16,101,18,"appUser"],[103,23,101,25],[104,10,101,27,"isLoading"],[104,19,101,36],[104,21,101,38],[104,26,101,43],[105,10,101,45,"debugLog"],[105,18,101,53],[105,20,101,55,"logLines"],[105,28,101,63],[105,29,101,64,"join"],[105,33,101,68],[105,34,101,69],[105,38,101,73],[106,8,101,75],[106,9,101,76],[106,10,101,77],[107,8,102,6],[107,15,102,13],[107,19,102,17],[108,6,104,4],[108,7,104,5],[108,8,104,6],[108,15,104,13,"err"],[108,18,104,21],[108,20,104,23],[109,8,105,6,"logLines"],[109,16,105,14],[109,17,105,15,"push"],[109,21,105,19],[109,22,105,20],[109,43,105,41,"err"],[109,46,105,44],[109,47,105,45,"message"],[109,54,105,52],[109,56,105,54],[109,57,105,55],[110,8,106,6,"console"],[110,15,106,13],[110,16,106,14,"log"],[110,19,106,17],[110,20,106,18],[110,45,106,43],[110,47,106,45,"err"],[110,50,106,48],[110,51,106,49],[111,8,107,6,"set"],[111,11,107,9],[111,12,107,10],[112,10,107,12,"isLoading"],[112,19,107,21],[112,21,107,23],[112,26,107,28],[113,10,107,30,"error"],[113,15,107,35],[113,17,107,37],[113,38,107,58,"err"],[113,41,107,61],[113,42,107,62,"message"],[113,49,107,69],[113,51,107,71],[114,10,107,73,"debugLog"],[114,18,107,81],[114,20,107,83,"logLines"],[114,28,107,91],[114,29,107,92,"join"],[114,33,107,96],[114,34,107,97],[114,38,107,101],[115,8,107,103],[115,9,107,104],[115,10,107,105],[116,8,108,6],[116,15,108,13],[116,20,108,18],[117,6,109,4],[118,4,110,2],[118,5,110,3],[119,4,112,2],[120,4,113,2,"demoLogin"],[120,13,113,11],[120,15,113,13],[120,21,113,13,"demoLogin"],[120,22,113,13],[120,27,113,25],[121,6,114,4],[121,12,114,10,"config"],[121,18,114,16],[121,21,114,19],[121,25,114,19,"getSupabaseConfig"],[121,43,114,36],[121,44,114,36,"getSupabaseConfig"],[121,61,114,36],[121,63,114,37],[121,64,114,38],[122,6,115,4],[122,10,115,8],[122,11,115,9,"config"],[122,17,115,15],[122,18,115,16,"hasDemoCredentials"],[122,36,115,34],[122,38,115,36],[123,8,116,6,"set"],[123,11,116,9],[123,12,116,10],[124,10,116,12,"error"],[124,15,116,17],[124,17,116,19],[125,8,116,119],[125,9,116,120],[125,10,116,121],[126,8,117,6],[126,15,117,13],[126,20,117,18],[127,6,118,4],[128,6,120,4],[128,13,120,11,"get"],[128,16,120,14],[128,17,120,15],[128,18,120,16],[128,19,120,17,"login"],[128,24,120,22],[128,25,120,23,"config"],[128,31,120,29],[128,32,120,30,"demoEmail"],[128,41,120,39],[128,43,120,41,"config"],[128,49,120,47],[128,50,120,48,"demoPassword"],[128,62,120,60],[128,63,120,61],[129,4,121,2],[129,5,121,3],[130,4,123,2,"signOut"],[130,11,123,9],[130,13,123,11],[130,19,123,11,"signOut"],[130,20,123,11],[130,25,123,23],[131,6,124,4],[131,10,124,8],[132,8,125,6],[132,14,125,12,"AsyncStorage"],[132,26,125,24],[132,27,125,24,"default"],[132,34,125,24],[132,35,125,25,"removeItem"],[132,45,125,35],[132,46,125,36,"AUTH_STORAGE_KEY"],[132,62,125,52],[132,63,125,53],[133,6,126,4],[133,7,126,5],[133,8,126,6],[133,15,126,13,"err"],[133,18,126,16],[133,20,126,18],[134,8,127,6,"console"],[134,15,127,13],[134,16,127,14,"log"],[134,19,127,17],[134,20,127,18],[134,50,127,48],[134,52,127,50,"err"],[134,55,127,53],[134,56,127,54],[135,6,128,4],[136,6,129,4,"set"],[136,9,129,7],[136,10,129,8],[137,8,129,10,"user"],[137,12,129,14],[137,14,129,16],[138,6,129,21],[138,7,129,22],[138,8,129,23],[139,4,130,2],[139,5,130,3],[140,4,132,2,"checkSession"],[140,16,132,14],[140,18,132,16],[140,24,132,16,"checkSession"],[140,25,132,16],[140,30,132,28],[141,6,133,4],[141,10,133,8],[142,8,134,6],[142,14,134,12,"storedUser"],[142,24,134,22],[142,27,134,25],[142,33,134,31,"AsyncStorage"],[142,45,134,43],[142,46,134,43,"default"],[142,53,134,43],[142,54,134,44,"getItem"],[142,61,134,51],[142,62,134,52,"AUTH_STORAGE_KEY"],[142,78,134,68],[142,79,134,69],[143,8,135,6],[143,12,135,10,"storedUser"],[143,22,135,20],[143,24,135,22],[144,10,136,8],[144,16,136,14,"user"],[144,20,136,18],[144,23,136,21,"JSON"],[144,27,136,25],[144,28,136,26,"parse"],[144,33,136,31],[144,34,136,32,"storedUser"],[144,44,136,42],[144,45,136,54],[145,10,137,8,"console"],[145,17,137,15],[145,18,137,16,"log"],[145,21,137,19],[145,22,137,20],[145,57,137,55],[145,59,137,57,"user"],[145,63,137,61],[145,64,137,62,"email"],[145,69,137,67],[145,70,137,68],[146,10,138,8,"set"],[146,13,138,11],[146,14,138,12],[147,12,138,14,"user"],[148,10,138,19],[148,11,138,20],[148,12,138,21],[149,8,139,6],[150,6,140,4],[150,7,140,5],[150,8,140,6],[150,15,140,13,"err"],[150,18,140,16],[150,20,140,18],[151,8,141,6,"console"],[151,15,141,13],[151,16,141,14,"log"],[151,19,141,17],[151,20,141,18],[151,45,141,43],[151,47,141,45,"err"],[151,50,141,48],[151,51,141,49],[152,6,142,4],[153,4,143,2],[154,2,144,0],[154,3,144,1],[154,4,144,2],[154,5,144,3],[155,0,144,4],[155,3]],"functionMap":{"names":["<global>","create$argument_0","setUser","setError","login","demoLogin","signOut","checkSession"],"mappings":"AAA;8CC2B;WCM,uBD;YEC,yBF;SGG;GHwE;aIG;GJQ;WKE;GLO;gBME;GNW;EDC"},"hasCjsExports":false},"type":"js/module"}]}